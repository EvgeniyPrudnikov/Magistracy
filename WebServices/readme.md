# Web Service

## News

Сервис для просмотра новостей, редактирования источников новостей (добавления, удаления, изменения) 

# Architecture :

## REST

Для данного сервиса хорошо подходит REST архитектура, так как : 
 - добавление, изменения, редактирование источников новостей, а также сами новости (как ресурс), хорошо описываются моделью без состояний (Stateless)
   (серверу ничего не нужно знать о состоянии клиентов)
 - данные о источниках, а также новости (за прошлые даты (новости не могут добовляться задним числом) ) можно кэшировать (Cacheable)
 - достаточно использовать CRUD операции для "общения" с сервисом
 - управление ресурсами через представления ( достаточно передать представление (в данном сервисе не нужны "глаголы") ) 
 - самодостаточные сообщения

# API

## Ресурсы:

 - коллекция источников
 - источник
 - коллекция новостей
 - новость

## Запросы:

При успешном выполнении GET запросов придет код 
```
HTTP/1.1 200 Ok 
Date: ...
Content-Length:  ...
```
а также сама запрашиваемая информация.

#### Получаем колекцию источников новостей пользователя (их не много, можно не использовать фильтры):
```
GET /sources/
```
#### Пример ответа сервера:
```
{ 
	"items":[
				{ 
				 "source_uri": "/sources/{id}" // id источнка в пользовательской коллекции
				 ,"source_global_uri": " ... " // глобальный url источника (например tut.by)
				 ,"source_name": " ... "  // имя источника новостей (пример: СБ Беларусь сегодня :) ) 
				 ,"source_desc": " ... "  // краткое описание источника (новости спорта/политика/финансы и тд) может быть пустым (например СБ Беларусь сегодня - там есть все новости)
				 ,"source_label": " ... " // url на картинку на сервере (может быть пустым)
				}
				,
				{
				 "source_uri": "/sources/{id}"
				 ,"source_global_uri":" ... "
				 ,"source_name": " ... "
				 ,"source_desc": " ... "
				 ,"source_label": " ... "
				}
				,
				{...}
				, 
				...
			]
}
```
 
#### Получаем коллекцию новостей пользовательских источников лимитированную (по умолчанию ) по дате новости ( не старше 2 дней):

Новости с датами - 1 день от текущей даты и дальше(-2,-3 ... ) можно кэшировать;

 - Параметр start_dt=current_date (ISO8601) - означает текущую дату
 - Параметр end_dt=-2 означает минус 2 дня от текущей даты
 - Параметр source_id= означает получение новостей из конкретного источника (одного из существующих в системе)
   если пустой, значит получить новости из всех существующих в системе источников

```
GET /news?start_dt=current_date&end_dt=-2&source_id=
```
#### Пример ответа сервера:
```
{ 
	"items":[
			{ 
			  "news_uri": "/news/{news_id}"
			 ,"source_uri": "/sources/{id}"
			 ,"source_name": " ... " // имя источника новостей (пример: СБ Беларусь сегодня :) )
			 ,"news_date": "{news_date}" // дата появления/обновления новости
			 ,"news_title": " ... " // заголовок/имя новости
			 ,"preview":" ...  " // 1 - 2 абзаца тела новости
			}
			,
			{
			  "news_uri": "/sources/news/{news_id}"
			 ,"source_uri": "/sources/{id}"
			 ,"source_name": " ... "
			 ,"news_date": "{news_date}"
			 ,"news_title": " ... " 
			 ,"preview":" ...  " 
			}
			,
			{...}
			, 
			...
		]
}
```
#### Получаем отдельную статью:
```
GET /news/{news_id}
```
#### Пример ответа сервера:

```

{ 
	 "items":{ 
			  "news_uri": "/news/{news_is}"
			 ,"source_uri": "/sources/{id}"
			 ,"source_name": " ... " // имя источника новостей (пример: СБ Беларусь сегодня :) )
			 ,"news_date": "{news_date}" // дата появления/обновления новости
			 ,"news_title": " ... " // заголовок/имя новости
			 ,"news_body_full":{ html ...  } // тело новости
			 ,"news_author":" ... " 
			 ,"news_tags":" ... "
			 
		}
	
}

```
 
#### Получаем отдельный источник новостей:
```
GET /sources/{id}
```
#### Пример ответа сервера:
```
{ 
	"items": { 
			 "source_uri": "/sources/{id}" // id источнка в пользовательской коллекции
			 ,"source_global_uri": " ... " // глобальный url источника (например tut.by)
			 ,"source_name": " ... "  // имя источника новостей (пример: СБ Беларусь сегодня :) ) 
			 ,"source_desc": " ... "  // краткое описание источника (новости спорта/политика/финансы и тд) может быть пустым (например СБ Беларусь сегодня - там есть все новости)
			 ,"source_label": " ... " // url на картинку на сервере (может быть пустым)
		}
}
```
 
#### Добовляем/обновляем источник новостей (клиент предоставляет url источника, имя (name) и описание (desc) (если они пустые сервер достает их сам из источника )  и на сервер умеет получать новости по url(например tut.by) )):
Для id источника можно использовать хэш по url и соответственно клиент может посчитать его сам
```
PUT /sources/{id}
```
#### Пример ответа сервера: 
```
HTTP/1.1 201 Created
Date: ...
Content-Length: ...  
Content-Type: json;charset="utf-8"
Location: /sources/{id}
	... 

{ 
	"items": { 
		 "source_uri": "/sources/{id}" // id источнка в пользовательской коллекции
		 ,"source_global_uri": " ... " // глобальный url источника (например tut.by)
		 ,"source_name": " ... "  // имя источника новостей (пример: СБ Беларусь сегодня :) ) 
		 ,"source_desc": " ... "  // краткое описание источника (новости спорта/политика/финансы и тд) может быть пустым (например СБ Беларусь сегодня - там есть все новости)
		 ,"source_label": " ... " // url на картинку на сервере (может быть пустым)
	}
}
```

Если объект не изменился, придет ответ:

```
HTTP/1.1 304 Not Modified
Date: ... 
```

Если объект успешно обновился, придет ответ:
```
HTTP/1.1 200 Ok 
Date: ... 
Content-Length: ...
```
#### Удаляем источник новостей: 
```
DELETE /sources/{id}
```



